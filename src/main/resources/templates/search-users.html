<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Search Users - FriendBook</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="icon" href="data:," />
</head>

<body>
    <div class="dashboard-container">
        <h2>Search Users</h2>

        <!-- Search Form -->
        <div class="create-post-card">
            <form th:action="@{/user/search}" method="get" class="create-post-form">
                <input type="hidden" name="email" th:value="${currentUser.email}" />
                <input type="text" name="keyword" placeholder="Search by name or email" th:value="${keyword}" required
                    style="margin-bottom:10px" />
                <button type="submit" class="btn-post">Search</button>
            </form>
        </div>

        <!-- Search Results -->
        <div th:if="${searchResults != null}">
            <h3>Search Results:</h3>
            <div class="posts">
                <div th:each="user : ${searchResults}" class="post-card">
                    <div class="post-header">
                        <!-- User profile pic -->
                        <img th:if="${user.profilePhoto != null}" th:src="@{'/uploads/' + ${user.profilePhoto}}"
                            alt="Profile Photo" class="post-user-pic" />
                        <div class="post-user-info">
                            <h4 th:text="${user.name}">User Name</h4>
                            <p th:text="${user.email}" class="post-date">Email</p>
                        </div>
                    </div>

                    <!-- Follow/Unfollow Button -->
                    <div style="margin-top:10px;">
                        <form th:action="@{/user/follow-toggle}" method="post">
                            <input type="hidden" name="email" th:value="${currentUser.email}" />
                            <input type="hidden" name="targetId" th:value="${user.id}" />
                            <button type="submit" class="btn"
                                th:text="${#lists.contains(#ids, user.id) ? 'Unfollow' : 'Follow'}">Follow</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div th:if="${searchResults == null or #lists.isEmpty(searchResults)}" style="margin-top:15px;">
            <p>No users found.</p>
        </div>
    </div>
</body>

</html>
